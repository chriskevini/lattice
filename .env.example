# ============================================================================
# DISCORD CONFIGURATION
# ============================================================================
DISCORD_TOKEN=your_bot_token_here

# Guild (Server) ID: Optional but recommended for validation
DISCORD_GUILD_ID=123456789012345678

# Main Channel: Primary user interaction, conversation, proactive check-ins
DISCORD_MAIN_CHANNEL_ID=123456789012345678

# Dream Channel: Meta activities, prompt optimization proposals, self-reflection
# Human approvals for prompt_registry updates happen here
DISCORD_DREAM_CHANNEL_ID=987654321098765432

# Bot Intents: Required for discord.py
# MESSAGE_CONTENT intent is required to read message content (privileged intent)
# Ensure these are enabled in Discord Developer Portal > Bot > Privileged Gateway Intents
# - MESSAGE CONTENT INTENT (required)
# - SERVER MEMBERS INTENT (optional, for user management)
# - PRESENCE INTENT (optional, for user status)

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
DATABASE_URL=postgresql://user:password@localhost:5432/lattice

# Connection pooling (optimized for 1vCPU)
DB_POOL_MIN_SIZE=2
DB_POOL_MAX_SIZE=5

# ============================================================================
# AI/ML CONFIGURATION
# ============================================================================
# LLM Provider: Choose 'anthropic' or 'openai'
LLM_PROVIDER=anthropic

# Anthropic Configuration (for Claude)
ANTHROPIC_API_KEY=sk-ant-api03-xxxxx
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
ANTHROPIC_MAX_TOKENS=1024

# OpenAI Configuration (alternative)
# OPENAI_API_KEY=sk-xxxxx
# OPENAI_MODEL=gpt-4o-mini
# OPENAI_MAX_TOKENS=1024

# Lightweight embedding model for 2GB RAM constraint (~80MB)
# Runs locally on CPU, no API key needed
EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
EMBEDDING_DIMENSION=384
EMBEDDING_CACHE_DIR=./models

# ============================================================================
# MEMORY CONFIGURATION - Hardware Constraints (2GB RAM / 1vCPU)
# ============================================================================
# PHILOSOPHY: System uses semantic archetype classification to determine optimal
# context configuration for each message type. These limits are enforced by
# context_archetypes table entries and prevent OOM crashes.
#
# Context is determined automatically via semantic similarity matching against
# archetype centroids. See docs/context-archetype-system.md for details.

# HARD LIMITS: Enforced by CHECK constraints in context_archetypes table
# These prevent archetypes (human or AI-proposed) from exceeding hardware capacity

# Episodic Memory: Recent conversation turns (sequential context)
MIN_EPISODIC_CONTEXT_TURNS=1
MAX_EPISODIC_CONTEXT_TURNS=20

# Semantic Memory: Vector search results (related facts/knowledge)
MIN_VECTOR_SEARCH_LIMIT=0
MAX_VECTOR_SEARCH_LIMIT=15

# Vector similarity threshold (0.0-1.0, higher = more similar)
MIN_SIMILARITY_THRESHOLD=0.5
MAX_SIMILARITY_THRESHOLD=0.9

# Semantic Triple Traversal: Graph relationship hops
MIN_TRIPLE_DEPTH=0
MAX_TRIPLE_DEPTH=3

# DEFAULT VALUES: Used when no archetype matches or for archetype proposals
DEFAULT_EPISODIC_CONTEXT_TURNS=10
DEFAULT_VECTOR_SEARCH_LIMIT=5
DEFAULT_SIMILARITY_THRESHOLD=0.7
DEFAULT_TRIPLE_DEPTH=1

# Embedding batch size for memory extraction (background process)
MAX_EMBEDDING_BATCH_SIZE=16

# Context archetype matching
# Minimum similarity score for archetype match (fallback to defaults if below)
MIN_ARCHETYPE_MATCH_SIMILARITY=0.6

# Cache duration for archetype centroids (seconds)
ARCHETYPE_CACHE_TTL=60

# ============================================================================
# PROACTIVE BEHAVIOR
# ============================================================================
# Proactive Interval: AI decides via NEXT_PROACTIVE_IN_MINUTES output
# This is a FAILSAFE if AI never sets next check-in time
DEFAULT_PROACTIVE_INTERVAL_MINUTES=120
MIN_PROACTIVE_INTERVAL_MINUTES=30
MAX_PROACTIVE_INTERVAL_MINUTES=1440  # 24 hours

# Dreaming Cycle: Self-analysis and prompt optimization proposals
# Posts to DISCORD_DREAM_CHANNEL_ID for human approval
DREAMING_CYCLE_CRON=0 3 * * *  # 3:00 AM daily



# ============================================================================
# LOGGING
# ============================================================================
LOG_LEVEL=INFO
STRUCTURED_LOGS=true
LOG_FILE=logs/lattice.log

# ============================================================================
# PERFORMANCE
# ============================================================================
MAX_WORKERS=2
REQUEST_TIMEOUT_SECONDS=30

# Memory budget for query operations (in MB, out of 2048 total)
MEMORY_BUDGET_MB=1500
